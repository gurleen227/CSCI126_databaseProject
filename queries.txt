--Queries

-- Query 1 - Sub query example

SELECT ItemListId AS Item, avg(CurrentPrice) AS AveragePrice FROM (
SELECT CurrentPrice, ItemListId
FROM itemhistory
WHERE ItemListId = 13265) myTable;


--Query 2 - Sub Query example
SELECT itemlist.Name, itemlist.ItemId AS IdNumber, itemstatuses.MembersOnly AS IsMembersOnly
FROM itemlist NATURAL JOIN itemstatuses
WHER Name=”Cannonball”;

--Query 3 - Sub Query example
select list.ItemId,
list.Name,
round(history.Prices, 2) as 'Average Prices',
list.MembersOnly as 'Members Only?'
from (
	select b.Name, b.ItemId, a.MembersOnly from ItemList as b
	join ItemStatuses as a on a.ItemId = b.ItemId
) as list
join (
	select ItemListId, AVG(ItemHistory.CurrentPrice) as Prices from ItemHistory
	group by ItemListId
) as history on list.ItemId = history.ItemListId
where list.MembersOnly = 'false'
order by history.Prices desc

--Query 4 - Aggregation query example
SELECT Name, ItemListId AS ItemID, min(CurrentPrice) AS Min FROM
	(SELECT itemhistory.ItemListId, itemhistory.CurrentPrice, itemlist.Name, itemlist.ItemId
	FROM itemhistory JOIN itemlist
	WHERE itemListId = ItemId AND Name="Avantoe") myTable;


--Query 5 - Aggreagtion query example
INSERT INTO ItemAverages  (ItemId, AveragePrice)
	SELECT  ItemListId, AVG(CurrentPrice)
	FROM ItemHistory
	GROUP BY ItemListId;


--Query 6 - Insert query example
INSERT INTO ItemAverages  (ItemId, AveragePrice)
    select  ItemListId, AVG(CurrentPrice)
    from ItemHistory
    group by ItemListId;


-Query 7 - Update query example
UPDATE itemicons
SET ImageIcon = REPLACE(ImageIcon, '1644242624151', '1651660195037')
WHERE ItemId > 1;

--Query 8 - Other query
SELECT itemlist.Name, itemhistory.Date, itemhistory.ItemListId, itemhistory.TrendValue 
FROM itemlist natural join itemhistory 
WHERE itemhistory.ItemListId = itemlist.ItemId
ORDER BY TrendValue DESC 
LIMIT 10;

--Query 9 -- Other query
SELECT Date, COUNT(Date) AS NumPos,Trend
FROM itemhistory 
WHERE Trend = "positive"
GROUP BY Date
Order by NumPos DESC
LIMIT 10;

